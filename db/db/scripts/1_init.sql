CREATE ROLE postgres WITH LOGIN PASSWORD 'gfityf_voul_4586';
CREATE ROLE API_ADMIN WITH LOGIN PASSWORD 'gfityf_voul_4586';

CREATE DATABASE DATA_BASE_API OWNER API_ADMIN;


CREATE TABLE ADDRESS(
	ID INT,
	PAYS VARCHAR(50),
	VILLE VARCHAR (50),
	RUE VARCHAR(50),
	LIEU_DIT VARCHAR(50),
	GPS VARCHAR(50),
	PRIMARY KEY (ID)
);

CREATE TABLE CLIENT (
	ID INT,
	USER_NAME VARCHAR (50) NOT NULL,
	USER_SURNAME VARCHAR(50) NOT NULL,
	MDP VARCHAR(50),
	BANKID VARCHAR(50),
	PRIMARY KEY (ID)
	
);

CREATE TABLE HOTEL (
	HOTEL_ID INT,
	NAME VARCHAR(50),
	ETOILE INT,
	ADDRESS INT,
	PRIMARY KEY (HOTEL_ID),
	FOREIGN KEY (ADDRESS) REFERENCES ADDRESS(ID)
);

CREATE TABLE CHAMBRE (
	NUMERO INT,
	HOTEL_ID INT,
	PRIX FLOAT,
	LIT INT,
	IMAGE BYTEA,
	PRIMARY KEY (NUMERO, HOTEL_ID),
	FOREIGN KEY (HOTEL_ID) REFERENCES HOTEL(HOTEL_ID)
);



CREATE TABLE RESERVATION(
	IDR SERIAL,
	IDC int,
	IDH int,
	DATE_D DATE,
	DATE_F DATE,
	IDCLIENT INT,
	PRIMARY KEY (IDR),
	FOREIGN KEY (IDCLIENT) REFERENCES CLIENT(ID),
	FOREIGN KEY (IDC, IDH) REFERENCES CHAMBRE(NUMERO, HOTEL_ID)
);

CREATE TABLE AGENCE (
	IDA INT,
	TARIF INT,
	PRIMARY KEY (IDA)
);

CREATE TABLE EST_AGENCE(
	IDA INT,
	IDH INT,
	TARIF INT,
	MDP VARCHAR(50),
	PRIMARY KEY (IDA,IDH),
	FOREIGN KEY (IDH) REFERENCES HOTEL(HOTEL_ID),
	FOREIGN KEY (IDA) REFERENCES AGENCE(IDA)
);


-- Insertion de données dans la table ADDRESS
INSERT INTO ADDRESS VALUES (0, 'FRANCE', 'MONTPELLIER', '153 RUE FOCH', 'PLACEHOLDER', 'GPS');
INSERT INTO ADDRESS VALUES (1, 'FRANCE', 'PARIS', '10 AVENUE DES CHAMPS', 'PLACEHOLDER', 'GPS');
INSERT INTO ADDRESS VALUES (2, 'FRANCE', 'NICE', '5 RUE DE LA PAIX', 'PLACEHOLDER', 'GPS');
INSERT INTO ADDRESS VALUES (3, 'FRANCE', 'LYON', '20 RUE DE LION', 'PLACEHOLDER', 'GPS');

-- Insertion de données dans la table CLIENT
INSERT INTO CLIENT VALUES (1, 'John', 'Doe', 'password','123BANK');
INSERT INTO CLIENT VALUES (2, 'Jane', 'Smith', 'password','456BANK');
INSERT INTO CLIENT VALUES (3, 'Mike', 'Johnson', 'password','789BANK');

-- Insertion de données dans la table HOTEL
INSERT INTO HOTEL VALUES (1, 'Grand Hotel', 5, 1);
INSERT INTO HOTEL VALUES (2, 'Ocean View', 4, 2);
INSERT INTO HOTEL VALUES (3, 'Mountain Retreat', 3, 3);

-- Insertion de données dans la table CHAMBRE
INSERT INTO CHAMBRE VALUES (101, 1, 150.00, 2, NULL);
INSERT INTO CHAMBRE VALUES (102, 1, 200.00, 3, NULL);
INSERT INTO CHAMBRE VALUES (201, 2, 100.00, 2, NULL);
INSERT INTO CHAMBRE VALUES (202, 2, 120.00, 1, NULL);
INSERT INTO CHAMBRE VALUES (301, 3, 80.00, 1, NULL);
INSERT INTO CHAMBRE VALUES (302, 3, 90.00, 2, NULL);

-- Insertion de données dans la table RESERVATION
INSERT INTO RESERVATION VALUES (DEFAULT, 101, 1, '2024-01-01', '2024-01-10', 1);
INSERT INTO RESERVATION VALUES (DEFAULT, 102, 1, '2024-02-15', '2024-02-20', 2);
INSERT INTO RESERVATION VALUES (DEFAULT, 201, 2, '2024-03-01', '2024-03-05', 3);


-- Insertion de données dans la table AGENCE
INSERT INTO AGENCE VALUES (1, 10);
INSERT INTO AGENCE VALUES (2, 20);
INSERT INTO AGENCE VALUES (3, 30);

-- Insertion de données dans la table EST_AGENCE
INSERT INTO EST_AGENCE VALUES (1, 1, 10, 'password123');
INSERT INTO EST_AGENCE VALUES (2, 2, 20, 'password456');
INSERT INTO EST_AGENCE VALUES (3, 3, 30, 'password789');





/*ALTER TABLE USERS ADD CONSTRAINT PK_USERS PRIMARY KEY (USER_ID);

ALTER TABLE USERS ADD CONSTRAINT UNIQUE_USER_TWICH_ID UNIQUE (USER_ID_TWICH);

ALTER TABLE CHARACTERS ADD CONSTRAINT PK_CHARACHTERS PRIMARY KEY (CHARACTER_ID);

ALTER TABLE KINGDOMS ADD CONSTRAINT PK_KINGDOMS PRIMARY KEY (KINGDOMS_ID);

ALTER TABLE CHARACTERS ADD CONSTRAINT ROLE_CHARACTER CHECK (ROLE IN ('PEASANT','LORD','SOLDIEUR','WOODSMAN','HUNTER','BUILDER','ARTISAN'));

ALTER TABLE CHARACTERS ADD CONSTRAINT FK_CHARACTERS_TO_USERS FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID);

ALTER TABLE CHARACTERS ADD CONSTRAINT FK_CHARACTERS_TO_KINGDOM FOREIGN KEY (KINGDOMS_ID) REFERENCES KINGDOMS(KINGDOMS_ID);
*/

